# [# 가비지 컬렉션](https://ko.javascript.info/garbage-collection)
* 자바스크립트 엔진은 더이상 쓸모 없어지게 된 원시값, 객체, 함수 등을 찾아 삭제한.

## 가비지 컬렉션 기준
### 도달 가능성(reachability)
1. 루트는 태생부터 도달 가능하기 때문에 명백한 이유 없이 사용되지 않는다.
2. 루트가 참조하는 값이나 체이닝으로 루투에서 참조할 수 있는 값은 도달 가능한 값이 된다.

**루트**란: 
* 현재 함수의 지역 변수와 매개변수
* 중첩 함수의 체인에 있는 함수에서 사용되는 변수와 매개변수
* 전역 변수
* 기타 등등

## 가비지 컬렉터
모든 객체를 모니터링하고 도달할 수 없는 객체를 삭제한다.
```javascript
// user엔 객체 참조 값이 저장됩니다.
let user = {
  name: "John" // (이하 John)
};

user = null
// user에 null을 할당해 객체 John에 접근, 참조할 방법이 사라졌다.
// 가비지 컬렉터는 John에 저장된 데이터를 삭제하고 John을 메모리에서 삭제한다.
// user은 도달할 수 없는 섬과 같은 상태가 된다.
```

## 내부 알고리즘 'mark-and-sweep'
* 가비지 컬렉터는 루트(root) 정보를 수집하고 이를 ‘mark(기억)’ 합니다.
* 루트가 참조하고 있는 모든 객체를 방문하고 이것들을 ‘mark’ 합니다.
* mark 된 모든 객체에 방문하고 그 객체들이 참조하는 객체도 mark 합니다. 한번 방문한 객체는 전부 mark 하기 때문에 같은 객체를 다시 방문하는 일은 없습니다.
* 루트에서 도달 가능한 모든 객체를 방문할 때까지 위 과정을 반복합니다.
* mark 되지 않은 모든 객체를 메모리에서 삭제합니다.

### 최적화 기법
* **gernerational collection(세대별 수집)** : '새로운 객체'를 공격적으로 메모리에서 제거한다. 일정시간 이상 동안 살아남은 객체는 '오래된 객체'로 분류하고, 가비지 컬릭터가 덜 감시한다. 
* **incremental collection(점진적 수집)**: 가비지 컬렉션을 여러 부분으로 분리한 다음, 각 부분을 별도로 수행한다. 작업을 분리하고, 변경사항을 추적하는데 추가 작업이 필요하지만 긴 지연을 짧은 지연 여러 개로 분산시킬 수 있다는 장점이 있다.
* **idle-time collection(유휴 시간 수집)**: 가비지 컬렉터는 실행에 주는 영향을 최소화하기 위해 CPU가 유휴 상태일 때에만 가비지 컬렉션을 실행합니다.

```
유휴 상태란? 
장치는 조작 가능한 상태에 있으나 사용되고 있지 않은 동안의 시간(idle time)이나, 장치가 작업을 개시하기 위한 명령을 대기하고 있는 상태(유휴 상태)를 나타낸다.
```
