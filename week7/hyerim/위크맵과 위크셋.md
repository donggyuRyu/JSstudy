# [5.8 ìœ„í¬ë§µê³¼ ìœ„í¬ì…‹](https://ko.javascript.info/weakmap-weakset)

## ìœ„í¬ë§µ
* í‚¤ê°€ ë°˜ë“œì‹œ ê°ì²´ì—¬ì•¼ í•œë‹¤. (ì›ì‹œê°’ì€ ìœ„í¬ë§µì˜ í‚¤ê°€ ë  ìˆ˜ ì—†ë‹¤)
* `keys()`, `values()`, `entries()`, ë°˜ë³µì‘ì—… ì—†ë‹¤. 
*  ì§€ì› ë©”ì„œë“œ
    * `weakMap.get(key)`
    * `weakMap.set(key, value)`
    * `weakMap.delete(key)`
    * `weakMap.has(key)`


### ìœ ìŠ¤ ì¼€ì´ìŠ¤: ì¶”ê°€ ë°ì´í„°
* *ë¶€ì°¨ì ì¸ ë°ì´í„°*ë¥¼ ì €ì¥
* ìœ„í¬ë§µì— ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ , ì´ë•Œ í‚¤ëŠ” ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ê°ì²´ê°€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì˜ ëŒ€ìƒì´ ë  ë•Œ, ë°ì´í„°ë„ í•¨ê»˜ ì‚¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤.

```javascript
// ğŸ“ visitsCount.js
let visitsCountMap = new WeakMap(); // ìœ„í¬ë§µì— ì‚¬ìš©ìì˜ ë°©ë¬¸ íšŸìˆ˜ë¥¼ ì €ì¥í•¨

// ì‚¬ìš©ìê°€ ë°©ë¬¸í•˜ë©´ ë°©ë¬¸ íšŸìˆ˜ë¥¼ ëŠ˜ë ¤ì¤ë‹ˆë‹¤.
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
```

### ìœ ìŠ¤ ì¼€ì´ìŠ¤: ìºì‹±
* ìºì‹±: ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…ì˜ ê²°ê³¼ë¥¼ ì €ì¥í•´ì„œ ì—°ì‚° ì‹œê°„ê³¼ ë¹„ìš©ì„ ì ˆì•½í•´ì£¼ëŠ” ê¸°ë²•.
* ë™ì¼í•œ í•¨ìˆ˜ë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•´ì•¼ í•  ë•Œ, ìµœì´ˆ í˜¸ì¶œ ì‹œ ë°˜í™˜ëœ ê°’ì„ ì–´ë”˜ê°€ì— ì €ì¥í•´ ë†“ì•˜ë‹¤ê°€ ê·¸ë‹¤ìŒì—” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ëŒ€ì‹  ì €ì¥ëœ ê°’ì„ ì‚¬ìš©
```javascript
// ğŸ“ cache.js
let cache = new WeakMap();

// ì—°ì‚°ì„ ìˆ˜í–‰í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ìœ„í¬ë§µì— ì €ì¥í•©ë‹ˆë‹¤.
function process(obj) {
  if (!cache.has(obj)) {
    let result = /* ì—°ì‚° ìˆ˜í–‰ */ obj;

    cache.set(obj, result);
  }

  return cache.get(obj);
}

// ğŸ“ main.js
let obj = {/* ... ê°ì²´ ... */};

let result1 = process(obj);
let result2 = process(obj);

// ê°ì²´ê°€ ì“¸ëª¨ì—†ì–´ì§€ë©´ ì•„ë˜ì™€ ê°™ì´ nullë¡œ ë®ì–´ì”ë‹ˆë‹¤.
obj = null;

// ì´ ì˜ˆì‹œì—ì„  ë§µì„ ì‚¬ìš©í•œ ì˜ˆì‹œì²˜ëŸ¼ cache.sizeë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
// í•˜ì§€ë§Œ objê°€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì˜ ëŒ€ìƒì´ ë˜ë¯€ë¡œ, ìºì‹±ëœ ë°ì´í„° ì—­ì‹œ ë©”ëª¨ë¦¬ì—ì„œ ì‚­ì œë  ê²ë‹ˆë‹¤.
// ì‚­ì œê°€ ì§„í–‰ë˜ë©´ cacheì—” ê·¸ ì–´ë–¤ ìš”ì†Œë„ ë‚¨ì•„ìˆì§€ ì•Šì„ê²ë‹ˆë‹¤.
```

## ìœ„í¬ì…‹
* ê°ì²´ë§Œ ì €ì¥ ê°€ëŠ¥, ì›ì‹œê°’ì€ ì €ì¥ ë¶ˆê°€
* ì§€ì› ë©”ì„œë“œ: `add`, `has`, `delete`

**ìœ„í¬ë§µê³¼ ìœ„í¬ì…‹**
ë‹¨ì : ë°˜ë³µ ì‘ì—…ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. 
ìš©ë„: ê°ì²´ì™€ í•¨ê»˜ â€˜ì¶”ê°€â€™ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ìš©ë„ë¡œ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê³¼ì œ
### 'ì½ìŒ' ìƒíƒœì¸ ë©”ì‹œì§€ ì €ì¥í•˜ê¸°
```javascript
let messages = [
  {text: "Hello", from: "John"},
  {text: "How goes?", from: "John"},
  {text: "See you soon", from: "Alice"}
];

let readMessages = new WeakSet();

// ë©”ì‹œì§€ ë‘ ê°œê°€ ì½ìŒ ìƒíƒœë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.
readMessages.add(messages[0]);
readMessages.add(messages[1]);
// readMessagesì—” ìš”ì†Œ ë‘ ê°œê°€ ì €ì¥ë©ë‹ˆë‹¤.

// ì²« ë²ˆì§¸ ë©”ì‹œì§€ë¥¼ ë‹¤ì‹œ ì½ì–´ë´…ì‹œë‹¤!
readMessages.add(messages[0]);
// readMessagesì—ëŠ” ìš”ì†Œ ë‘ ê°œê°€ ì—¬ì „íˆ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤(ì¤‘ë³µ ìš”ì†Œ ì—†ìŒ).

// "'message[0]'ì€ ì½ìŒ ìƒíƒœì¸ê°€ìš”?"ì— ëŒ€í•œ ë‹µë³€
alert("message 0ì€ ì½ìŒ ìƒíƒœì¸ê°€ìš”?: " + readMessages.has(messages[0])); // true

messages.shift();
// ì´ì œ readMessagesì—ëŠ” ìš”ì†Œê°€ í•˜ë‚˜ë§Œ ë‚¨ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤(ì‹¤ì œ ë©”ëª¨ë¦¬ì—ì„œ ì‚¬ë¼ì§€ëŠ” ê±´ ë‚˜ì¤‘ì´ ë˜ê² ì§€ë§Œ ë§ì´ì£ ).
```
### ì½ì€ ë‚ ì§œ ì €ì¥í•˜ê¸°
```javascript
let messages = [
  {text: "Hello", from: "John"},
  {text: "How goes?", from: "John"},
  {text: "See you soon", from: "Alice"}
];

let readMap = new WeakMap();

readMap.set(messages[0], new Date(2017, 1, 1));
// Date ê°ì²´ëŠ” ì¶”í›„ì— ë°°ìš°ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.
```
